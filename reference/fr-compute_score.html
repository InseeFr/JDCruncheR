<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calcul d'un score global — fr-compute_score • JDCruncheR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calcul d'un score global — fr-compute_score"><meta name="description" content="Permet de calculer un score global à partir d'un bilan qualité"><meta property="og:description" content="Permet de calculer un score global à partir d'un bilan qualité"><meta property="og:image" content="https://inseefr.github.io/JDCruncheR/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JDCruncheR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Package functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignette" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignette</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignette"><li><a class="dropdown-item" href="../articles/Using_the_cruncher_with_JDCruncheR.html">Using the cruncher with JDCruncheR</a></li>
    <li><a class="dropdown-item" href="../articles/Lancement_cruncher.html">Utiliser le cruncher avec JDCruncheR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-jdemetra-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">JDemetra+</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-jdemetra-"><li><a class="external-link dropdown-item" href="https://github.com/jdemetra/jdemetra-app/releases">To download JDemetra+</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/jdemetra/jwsacruncher/releases">To download the JDemetra+ cruncher</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/InseeFr/JDCruncheR/wiki/Installation-and-set-up-of-JDemetra-and-the-cruncher">Set up with a portable version of Java</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/rjdverse/rjdemetra" aria-label="GitHub"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calcul d'un score global</h1>
      <small class="dont-index">Source: <a href="https://github.com/InseeFr/JDCruncheR/blob/master/R/QR_functions.R" class="external-link"><code>R/QR_functions.R</code></a></small>
      <div class="d-none name"><code>fr-compute_score.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Permet de calculer un score global à partir d'un bilan qualité</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Objet de type <code><a href="QR_matrix.html">QR_matrix</a></code> ou <code><a href="QR_matrix.html">mQR_matrix</a></code>.</p></dd>


<dt id="arg-score-pond">score_pond<a class="anchor" aria-label="anchor" href="#arg-score-pond"></a></dt>
<dd><p>formule utilisée pour calculer le score global.</p></dd>


<dt id="arg-modalities">modalities<a class="anchor" aria-label="anchor" href="#arg-modalities"></a></dt>
<dd><p>modalités triées par ordre d'importance dans le calcul du
score (voir détails).</p></dd>


<dt id="arg-normalize-score-value">normalize_score_value<a class="anchor" aria-label="anchor" href="#arg-normalize-score-value"></a></dt>
<dd><p>Chiffre indiquant la valeur de référence pour la
normalisation des pondérations utilisées lors du calcul du score. Si le
paramètre n'est pas renseigné, les poids ne seront pas normalisés.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Booléen indiquant si les valeurs manquantes doivent être
enlevées pour le calcul du score.</p></dd>


<dt id="arg-n-contrib-score">n_contrib_score<a class="anchor" aria-label="anchor" href="#arg-n-contrib-score"></a></dt>
<dd><p>Entier indiquant le nombre de variables à créer dans
la matrice des valeurs du bilan qualité contenant les <code>n_contrib_score</code>
plus grandes contributrices au score (voir détails). S'il n'est pas spécifié,
aucune variable n'est créée.</p></dd>


<dt id="arg-conditional-indicator">conditional_indicator<a class="anchor" aria-label="anchor" href="#arg-conditional-indicator"></a></dt>
<dd><p><code>list</code> contenant des listes ayant 3
éléments : "indicator", "conditions" et "condition_modalities". Permet de
réduire à 1 le poids de certains indicateurs en fonction des valeurs d'autres
variables (voir détails).</p></dd>


<dt id="arg-thresholds">thresholds<a class="anchor" aria-label="anchor" href="#arg-thresholds"></a></dt>
<dd><p><code>list</code> de vecteurs numériques. Seuils appliqués aux
différents tests afin de classer en modalités <code>Good</code>, <code>Uncertain</code>,
<code>Bad</code> et <code>Severe</code>.
Par défault, la valeur de l'option <code>"jdc_threshold"</code> est utilisée.
Vous pouvez appeler la fonction <code><a href="get_thresholds.html">get_thresholds</a></code> pour voir à quoi
doit ressemble l'objet <code>thresholds</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Autres paramètres non utilisés.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Un objet de type <code><a href="QR_matrix.html">QR_matrix</a></code> ou <code><a href="QR_matrix.html">mQR_matrix</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>La fonction <code>compute_score</code> permet de calculer un score à
partir des modalités d'un bilan qualité. Pour cela, chaque modalité est
associée à un poids défini par le paramètre <code>modalities</code>. Ainsi, le
paramètre par défaut étant <code>c("Good", "Uncertain", "Bad","Severe")</code>,
la valeur <code>"Good"</code> sera associée à la note 0, la valeur
<code>"Uncertain"</code> sera associée à la note 1, la valeur <code>"Bad"</code> sera
associée à la note 2 et la valeur <code>"Bad"</code> sera associée à la note 3.
Le calcul du score se fait grâce au paramètre <code>score_pond</code>, qui est un
vecteur numérique nommé contenant des poids et dont les noms correspondent
aux variables de la matrice des modalités à utiliser dans le score. Ainsi,
avec le paramètre
<code>score_pond = c(qs_residual_sa_on_sa = 10, f_residual_td_on_sa = 5)</code>
le score sera calculé à partir des deux variables <code>qs_residual_sa_on_sa</code>
et <code>f_residual_td_on_sa</code>. Les notes associées aux modalités de la
variable <code>qs_residual_sa_on_sa</code> seront multipliées par 10 et celles
associées à la variable <code>f_residual_td_on_sa</code> seront multipliées par 5.
Dans le calcul du score, certaines variables peuvent être manquantes: pour ne
pas prendre en compte ces valeurs dans le calcul, il suffit d'utiliser le
paramètre <code>na.rm = TRUE</code>. Le paramètre <code>normalize_score_value</code>
permet de normaliser les scores.
Par exemple, si l'on souhaite avoir des notes entre 0 et 20, il suffit
d'utiliser le paramètre <code>normalize_score_value = 20</code>. Le paramètre
<code>n_contrib_score</code> permet d'ajouter de nouvelles variables à la matrice
des valeurs du bilan qualité dont les valeurs correspondent aux noms des
variables qui contribuent le plus au score de la série.
<code>n_contrib_score</code> est un entier égal au nombre de variables
contributrices que l'on souhaite exporter. Par exemple, pour
<code>n_contrib_score = 3</code>, trois colonnes seront créées et elles
contiendront les trois plus grandes contributrices au score. Les noms des
nouvelles variables sont <em>i</em>_highest_score, <em>i</em> correspondant au rang en
terme de contribution au score (1_highest_score contiendra les noms des plus
grandes contributrices, 2_highest_score des deuxièmes plus grandes
contributrices, etc). Seules les variables qui ont une contribution non nulle
au score sont prises en compte. Ainsi, si une série a un score nul, toutes
les colonnes <em>i</em>_highest_score associées à cette série seront vides. Et si
une série a un score positif uniquement du fait de la variable "m7", alors la
valeur correspondante à la variable 1_highest_score sera égale à "m7" et
celle des autres variables <em>i</em>_highest_score seront vides. Certains
indicateurs peuvent n'avoir de sens que sous certaines conditions.
Par exemple, le test d'homoscédasticité n'est valide que si les résidus sont
indépendants et les tests de normalité, que si les résidus sont indépendants
et homoscédastiques. Le paramètre <code>conditional_indicator</code> permet de
prendre cela en compte en réduisant, sous certaines conditions, à 1 le poids
de certains variables. C'est une <code>list</code> contenant des listes ayant 3
éléments :</p><ul><li><p>"indicator" : nom de la variable pour laquelle on veut ajouter des
conditions</p></li>
<li><p>"conditions" : nom des variables que l'on utilise pour conditionner</p></li>
<li><p>"conditions_modalities" : modalités qui doivent être vérifiées pour
modifier le poids Ainsi, avec le paramètre
<code>conditional_indicator = list(list(indicator = "residuals_skewness",
  conditions = c("residuals_independency", "residuals_homoskedasticity"),
  conditions_modalities = c("Bad","Severe")))</code>, on réduit à 1 le poids de la
variable "residuals_skewness" lorsque les modalités du test d'indépendance
("residuals_independency") ou du test d'homoscédasticité
("residuals_homoskedasticity") valent "Bad" ou "Severe".</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Chemin menant au fichier demetra_m.csv</span></span></span>
<span class="r-in"><span><span class="va">demetra_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"JDCruncheR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"WS/ws_ipi/Output/SAProcessing-1"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"demetra_m.csv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extraire le bilan qualité à partir du fichier demetra_m.csv</span></span></span>
<span class="r-in"><span><span class="va">QR</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_QR.html">extract_QR</a></span><span class="op">(</span><span class="va">demetra_path</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the score</span></span></span>
<span class="r-in"><span><span class="va">QR</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_score.html">compute_score</a></span><span class="op">(</span><span class="va">QR</span>, n_contrib_score <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">QR</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The quality report matrix has 13 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are 19 indicators in the modalities matrix and 23 indicators in the values matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The quality report matrix contains the following variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> series  residuals_homoskedasticity  residuals_skewness  residuals_kurtosis  qs_residual_sa_on_sa  f_residual_sa_on_sa  qs_residual_sa_on_i  f_residual_sa_on_i  f_residual_td_on_sa  f_residual_td_on_i  residuals_independency  residuals_normality  oos_mean  oos_mse  q  q_m2  m7  pct_outliers  frequency  arima_model  score  1_highest_contrib_score  2_highest_contrib_score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The variables exclusively found in the values matrix are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> frequency  arima_model  1_highest_contrib_score  2_highest_contrib_score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The smallest score is 60 and the greatest is 605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The average score is 373.846 and its standard deviation is 195.737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The following formula was used to calculate the score:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 * qs_residual_sa_on_sa + 30 * f_residual_sa_on_sa + 20 * qs_residual_sa_on_i + 20 * f_residual_sa_on_i + 30 * f_residual_td_on_sa + 20 * f_residual_td_on_i + 15 * oos_mean + 10 * oos_mse + 15 * residuals_independency + 5 * residuals_homoskedasticity + 5 * residuals_skewness + 5 * m7 + 5 * q_m2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extraire les modalités de la matrice</span></span></span>
<span class="r-in"><span><span class="va">QR</span><span class="op">[[</span><span class="st">"modalities"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"score"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  60 105 350 295  75 340 560 605 550 575 460 355 530</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tanguy Barthelemy, Alain Quartier-la-Tente, Anna Smyk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

